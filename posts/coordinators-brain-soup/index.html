<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How the Coordinator Pattern Broke My Brain | michael s.</title>

<meta name="keywords" content="" />
<meta name="description" content="Or how I learned to stop worrying and throw everything away.">
<meta name="author" content="">
<link rel="canonical" href="/posts/coordinators-brain-soup/" />
<link href="/assets/css/stylesheet.min.f0f24f1a73b04444e71e83fd4d810a33.css" integrity="md5-8PJPGnOwRETnHoP9TYEKMw==" rel="preload stylesheet"
    as="style">

<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.80.0" />


<meta property="og:title" content="How the Coordinator Pattern Broke My Brain" />
<meta property="og:description" content="Or how I learned to stop worrying and throw everything away." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/coordinators-brain-soup/" />
<meta property="article:published_time" content="2021-01-01T21:20:07+00:00" />
<meta property="article:modified_time" content="2021-01-01T21:20:07+00:00" /><meta property="og:site_name" content="michael s." />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How the Coordinator Pattern Broke My Brain"/>
<meta name="twitter:description" content="Or how I learned to stop worrying and throw everything away."/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How the Coordinator Pattern Broke My Brain",
  "name": "How the Coordinator Pattern Broke My Brain",
  "description": "Introduction. This was originally a presentation that I’d put together in early 2020 but since it doesn’t look like I’ll be standing in front of anyone other than my immediate …",
  "keywords": [
    
  ],
  "articleBody": "Introduction. This was originally a presentation that I’d put together in early 2020 but since it doesn’t look like I’ll be standing in front of anyone other than my immediate family for a while, I figured this would be the next best thing. So please imagine that we’re in a 80% full auditorium (I’m not greedy), the chairs are comfy and the host for the event has told some light hearted jokes to ease you into proceedings.\n “Up next is Michael to talk about Coordinators….”\n A gentle applause flutters around the room. You begrudgingly join in.\nI walk up to the podium, looking incredibly suave and sophisticated, a template for the kind of person who just knows what they’re talking about and commands respect from his peers.\nA hush settles, the lights go down and I lean towards the microphone to say….\nHello.   There was the word. And the word was: 'use of unresolved identifier'  A word of warning, the word “Coordinator” is going to be said so many times, that it may start to lose all sense of meaning. Which will actually help to give you a window into the pain my mind went through whilst putting this presentation (article) together.\nIn the beginning there was navigation.\nEvery mobile app or website will involve navigating from one view to another. And handling that in a clean way can become tricky.\nAbout eighteen months ago, I was working on a feature and began to feel that the code to handle flow through the app was getting messy.\nSo I looked to design patterns! There are a range of different methodologies to choose from, but I wanted to focus my attention on how to best handle navigation. I was (reasonably) happy with how I was constructing my model objects, dependencies, etc but this was one part that I felt was on the verge of becoming unmanageable. Looking into these different approaches I came across the coordinator pattern. Being able to extract navigation code into a dedicated object sounded just what I needed.\n Coordinators.   I spent an inordinate amount of time trying to pick the right colour scheme for my slides, but I think I did alright. Not bad for someone who’s colour blind, eh.  Here’s a simple idea of where the coordinator would sit in my app architecture. It’s one purpose in life — its sole reason to live — is to tell other views to either present or dismiss. All of the logic I had previously within my view controller could be moved out and dropped into something more relevant and with just one job to do. For example, I could have a coordinator which handles flow for when the app is first launched. Each controller can message back to the coordinator with which button has been tapped and the coordinator will decide which view to present next. Another nice thing is that coordinators can call out to other coordinators.\n  Even the shade of green there took about a day to get right.  Looking at our first launch coordinator, we could call out to a “new account coordinator” which begins it’s own child flow which may include things such as entering an email address, choosing a secure password or validating with a two-factor token. This child flow is completely managed within the “new account coordinator” and, in a kinda selfish way, the parent coordinator just doesn’t care what it does. The only thing it does give a shit about is knowing when it’s done. Kinda like when you go to a restaurant. You don’t care how they make your confit de canard, just as long as they bring it to you on a plate rather than a wooden board.\nAnd the cool thing with this, is that you can have as many coordinators as you like, each calling child flows that have a focused concern on a particular part of the user journey and each of them work in isolation until they are complete.\nSee, coordinators are useful! It means that:\n Our view controllers can become egotistical — they neither know or care about anyone else. Which reduces the amount of code they contain, helping to make our controllers more easily testable. The view controller interface is clearly defined. Using either well-named and descriptive delegation or closure properties, we can see at a glance what the intended functionality of a particular view is — does it have multiple actions? Does it just dismiss on completion? A coordinator defines the order of presentation. This means that if a requirement changes whereby a new view is needed in our “first launch coordinator” that requests consent to the hundred different tracking SDK’s we use, we can add that in just the coordinator and every other view remains unaware of where it sits within that flow. It also means that a coordinator can be reused within different contexts, helping to reduce code duplication. And finally this separation of concerns means that each individual element of our flow can be more easily tested, giving us a higher confidence that we’re doing the right thing.   Implementation. The implementation of the coordinator pattern is well documented. It hinges on a protocol with one function declaration — start.\nThis is the jumping off point for everything that the user flow has to do. The calling class just says “Hey, customer feedback coordinator! Start!”\nAnd off it goes, happily presenting user input forms, confirmation windows or modal dialogues letting the user know that sorry, mismatched plates or a lack of three-ply loo roll aren’t a valid reason to demand a refund on your rented holiday home.\nSo what’s the problem? Everything looks great!\nWell….maybe… well, not quite.\n  [Emphasis mine]  In a lot of implementations of this pattern, the coordinator retains a collection of child coordinators. Unfortunately, this can lead to a situation where the view is deallocated when dismissed, but there is no mechanism to deallocate the coordinator. And there is one very important question with this….\nHow do we deallocate a coordinator? And the very important answer to this question is…\nYou don’t.\nAnd the reason you don’t? You can’t.\nThank you and good night. …. .. Ok, well actually that’s not quite true. There are many things you can do.\n Soroush Khanlou.   When I presented this slide to people I was being very dynamic, so imagine me swaying across the floor gesticulating wildly. There is also a typo on this slide which I’m mortified about.  One example is taken from Soroush Khanlou’s article on Advanced Coordinators.\nIt works, however in my view, it starts to steer away from the simple purpose of the coordinator.\nIt becomes the delegation for a navigation controller which means that it would override any previous implementation and cause that to stop working. It also begins to include logic that isn’t immediately apparent what the purpose is. This one method is called on both presentation and dismissal, it checks whether a specific view is contained within a retained collection of child coordinators, if so, it manually removes it from the store….all things that are ripe to cause the same memory issues that led us to this point.\nAbove all else, by making the coordinator the navigationControllerDelegate, you lose the interactive pop gesture….which is unacceptable.\nOverall, it just didn’t sit right with me and I quickly began looking for alternative solutions.\nBryan Irace.   In the real presentation, I’d have paced the words to closely fit the graphic. It took a lot of practise to get right, so I'm a bit disappointed I can't get the same effect in text.  Here’s another approach by Bryan Irace. In this, he’s taking the route of making a new controller object called a “NavigationController” (not confusing to me at all), which encapsulates both a coordinator and view controller.\nIt shares some DNA with Soroush Khanlou’s earlier method by having NavigationController be a UINavigationController delegate as well as the same method to specify which view or coordinator to deallocate. I’d say it’s much more complex than the previous approach, but does encapsulate away some behaviour.\nNeedless to say, I wasn’t keen to implement this version of the coordinator either.\nTutorials #101.   I also mentioned that all of these (waves hand vaguely in the region) are all worthwhile and absolutely worth your time reading.  There are tons of different articles and GitHub repo’s that cover this topic but none of them seemed to handle things in the way that I wanted — a light object and no requirement to manually deallocate anything.\nOne important thing to add here, and it is something to emphasis, is that none of the different approaches are wrong. They just didn’t seem to fit the way that I wanted it to work. I liked the concept, but couldn’t find an implementation that satisfied my….maybe I can call it “code lust”…no, actually that sounds sketchy. Let’s just say it didn’t satisfy my specific criteria.\nSo what did I do?\nI Gave Up. I’d stare listlessly out of the window looking for inspiration…\nI took long walks trying to figure out:\n “How can I cleanly remove a coordinator from memory?”.\n I’m not the most interesting of people, it must be said.\nBut then, I realised that we already had something in the structure of the application that managed both navigational flow and had the ability to let us know when objects were removed from memory.\n  Ting!  UIKit is cool. We have UIKit! It’s there, managing view hierarchies, throwing around objects, managing object retention and memory deallocation already. So let’s not fight against it.\nRather than coordinators retaining child coordinators, we make the initial view controller for a particular flow the “root view”, and that becomes the delegate of the coordinator.\nThe coordinator itself doesn’t have to change and we only need one root view for each coordinator flow.\nWhat does this look like in practise?\nIn our use case, the coordinator will create the view controllers, but not retain them.\nThe new root view will hold a reference back to the coordinator and as long as that root view lives (as part of the UIKit view hierarchy), then so will the coordinator.\nOther view controllers in the flow do not need to be coordinated. The coordinator is accessible via the root view controller for as long as it stays in memory. Of course, if there is an explicit need to reference a later view, you just need to have a weak reference to that specific controller.\nProtocols. Let’s keep the original protocol, I like that bit, and add a little spice to it.\nThere’s a new protocol called CoordinatedViewController, which specifies just two properties.\nThe calling coordinator, the one that just created this view controller.\nAnd a closure to be called when the view is deallocated.\n  The theme I use in Xcode is a slightly modified Solarize Dark, if you were wondering.  For the situation where we have child coordinator flows, I’ve added a property to the Coordinator protocol called coordinatorFlowComplete, which is called to tell it’s parent that this particular flow is finished. The parent then can do any other logic/navigation/cleanup that it needs to do with that information.\n  I could probably put it on GitHub or something.  Flow my views, the developer said. And this is how it looks in operation — simple!\n  Mr Lattner, I don’t feel so good.  Going from left to right, we see that a coordinator creates a view controller. The controller is retained by the view hierarchy, in this instance a UINavigationController, and the view retains the coordinator — our “Root View Controller”. As long as this root lives, so does the coordinator.\nIf the parent coordinator creates a child coordinator, the subsequent root retains that flow and so on…\nWe can walk this way across the whole user journey and once we’re complete, walk back off the stack deallocating views and coordinators as we go. Once a root view controller deallocates, so does all of the coordinator resources along with him, all the way back to the parent.\nSo using this approach, there are a few things to note.\n The memory lifecycle is consistent with how we expect our UIKit apps to work. We don’t have to be manually removing objects from retained objects, instead we just leverage our existing functions and observers. I’ve opted for protocol conformance rather than subclassing as that allows us to have a clearly defined “contract” with the specific view controller we want to become coordinated. As I mentioned earlier, not all views in a flow need to be coordinated and in this instance they don’t need to implement this protocol. Minimal code changes to existing coordinator implementations. Since all we have really done is flip the reference chain upside down, you can try this alongside your current approach and see how you fare. It also doesn’t require many changes to how view controllers are constructed. Most importantly of all, it doesn’t require the UINavigationControllerDelegate. Meaning I can still use the default interactive pop gesture. This is acceptable.   What’s the point?   https://xkcd.com/927  At the end of the day, all I’ve basically ended up with is yet another implementation on top of a giant pile of existing implementations. Why bother?\nSure, it shares some properties of a few different design patterns, but with one slight twist.\nThis one made sense to me.\nAnd that’s the real purpose of this article (talk), the code itself and the final pattern are mostly irrelevant.\nThis is really about the bit in the middle — how did I get this this point of being able to reach down, grab my variation on a theme and add it to the rest of the other ways of doing things?\nAnd there are really two key take aways I’d like to share on that point.\n1. There is always another way. Articles, blog posts, tweets or StackOverflow are incredible resources to have to help you find an approach to take. But they aren’t irrefutable.\nWe can read these other resources to give us an understanding of the problem we are trying to solve. And by understanding that problem, we’re able to come to our own conclusions and find a solution that works for the unique circumstances and requirements our project has.\nIt took me a long time to come to that solution, but having a grounding on how other people had attacked their problem enabled me to find something that fit our purpose.\nThis also means that the approach above may not work for you or your projects, but there may be some small element within there that nudges you one step further along your own journey to discovering your specific answer.\n2. Know what you want, not how to do it. Early on in this voyage of self-loathing, I knew that I wasn’t keen on many other implementations of this pattern. Even though I didn’t know how to do what I wanted, I had a clear idea of what I did want to happen, and what I didn’t want to happen.\nI wanted to have navigation taken out of the view controller.\nI didn’t want to have to manually deallocate objects.\nI wanted to do as little work as possible.\nAnd even though I struggled to achieve these goals, it helped me to throw away code when it didn’t satisfy my objective.\nWritten a class that doesn’t get deallocated? Throw the code away, try something else.\nCoordinator becoming bloated? Throw the code away, try something else.\nProtocol having too many properties? Throw the code away.\nBecause I knew how I wanted this thing to work, I was able to check off each of these requirements and if any part didn’t match up — I’d bin it and walk away. But on the flip side, when I was able to get an implementation that ticked all of those boxes, I knew that it worked.\nIn any software development process, the implementation is there to action the behaviour that you want to occur and I had to keep that in mind every time I tried to let existing code influence or determine how I attained that behaviour, even if it meant putting everything in the bin.\nFinal words. There you have it, this is what I presented once and may present again.\nI hope there is something in this that you find useful, even if it’s only in knowing that there is at least one person working in a professional capacity that wasn’t able to grasp the concept of coordinators without losing their mind.\nThere is a demo of this project available on GitHub, please take a look and see what you think. Maybe it won’t help, maybe it’ll make you laugh or maybe it’ll be a little pointer to helping you to find your own way of doing things.\nDemo project available at https://github.com/michaelsprindzuikate/coordinator_example\n",
  "wordCount" : "2812",
  "inLanguage": "en",
  "datePublished": "2021-01-01T21:20:07Z",
  "dateModified": "2021-01-01T21:20:07Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/coordinators-brain-soup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "michael s.",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>



</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="michael s. (Alt + H)">michael s.</a>
            <span class="logo-switches">
                <span class="theme-toggle" title="(Alt + T)">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()"></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      How the Coordinator Pattern Broke My Brain
    </h1>
    <div class="post-description">
      Or how I learned to stop worrying and throw everything away.
    </div>
    <div class="post-meta">January 1, 2021&nbsp;·&nbsp;14 min

    </div>
  </header> 

  <div class="post-content">
<h2 id="introduction">Introduction.<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>This was originally a presentation that I’d put together in early 2020 but since it doesn’t look like I’ll be standing in front of anyone other than my immediate family for a while, I figured this would be the next best thing.
So please imagine that we’re in a 80% full auditorium (I’m not greedy), the chairs are comfy and the host for the event has told some light hearted jokes to ease you into proceedings.</p>
<blockquote>
<p>“Up next is Michael to talk about Coordinators….”</p>
</blockquote>
<p>A gentle applause flutters around the room. You begrudgingly join in.</p>
<p>I walk up to the podium, looking incredibly suave and sophisticated, a template for the kind of person who just <strong>knows what they’re talking about and commands respect from his peers.</strong></p>
<p>A hush settles, the lights go down and I lean towards the microphone to say….</p>
<h2 id="hello">Hello.<a hidden class="anchor" aria-hidden="true" href="#hello">#</a></h2>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/01-beginning.jpeg#center" alt="First Slide. It says &amp;ldquo;In The Beginning&amp;rdquo;">
    <div class="caption">There was the word. And the word was: &#39;use of unresolved identifier&#39;</div>
  </figure>
</p>
<p>A word of warning, the word <em>“Coordinator”</em> is going to be said so many times, that it may start to lose all sense of meaning. Which will actually help to give you a window into the pain my mind went through whilst putting this presentation (article) together.</p>
<p>In the beginning there was navigation.</p>
<p>Every mobile app or website will involve navigating from one view to another. And handling that in a clean way can become tricky.</p>
<p>About eighteen months ago, I was working on a feature and began to feel that the code to handle flow through the app was getting messy.</p>
<p>So I looked to design patterns! There are a range of different methodologies to choose from, but I wanted to focus my attention on how to best handle navigation. I was (reasonably) happy with how I was constructing my model objects, dependencies, etc but this was one part that I felt was on the verge of becoming unmanageable. Looking into these different approaches I came across the <strong>coordinator pattern</strong>. Being able to extract navigation code into a dedicated object sounded just what I needed.</p>
<hr>
<h2 id="coordinators">Coordinators.<a hidden class="anchor" aria-hidden="true" href="#coordinators">#</a></h2>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/02-coordinator_placement.png#center" alt="Shows where a coordinator goes in the architecture">
    <div class="caption">I spent an inordinate amount of time trying to pick the right colour scheme for my slides, but I think I did alright. Not bad for someone who’s colour blind, eh.</div>
  </figure>
</p>
<p>Here’s a simple idea of where the coordinator would sit in my app architecture. It’s one purpose in life — <em>its sole reason to live</em> — is to tell other views to either present or dismiss. All of the logic I had previously within my view controller could be moved out and dropped into something more relevant and with just one job to do.
For example, I could have a coordinator which handles flow for when the app is first launched. Each controller can message back to the coordinator with which button has been tapped and the coordinator will decide which view to present next.
Another nice thing is that coordinators can call out to other coordinators.</p>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/03-coordinator_diagram.jpeg#center" alt="Shows where a coordinator goes in the architecture">
    <div class="caption">Even the shade of green there took about a day to get right.</div>
  </figure>
</p>
<p>Looking at our first launch coordinator, we could call out to a “new account coordinator” which begins it’s own <strong>child flow</strong> which may include things such as entering an email address, choosing a secure password or validating with a two-factor token. This child flow is completely managed within the “new account coordinator” and, in a kinda selfish way, the parent coordinator just doesn’t care what it does. The only thing it does give a shit about is knowing when it’s done. Kinda like when you go to a restaurant. You don’t care how they make your confit de canard, just as long as they bring it to you on a plate rather than a wooden board.</p>
<p>And the cool thing with this, is that you can have as many coordinators as you like, each calling child flows that have a focused concern on a particular part of the user journey and each of them work in isolation until they are complete.</p>
<p>See, coordinators are useful! It means that:</p>
<ul>
<li>Our view controllers can become <strong>egotistical</strong> — they neither know or care about anyone else. Which reduces the amount of code they contain, helping to make our controllers more easily testable.</li>
<li>The view controller interface is <strong>clearly defined</strong>. Using either well-named and descriptive delegation or closure properties, we can see at a glance what the intended functionality of a particular view is — does it have multiple actions? Does it just dismiss on completion?</li>
<li>A coordinator <strong>defines the order</strong> of presentation. This means that if a requirement changes whereby a new view is needed in our “first launch coordinator” that requests consent to the hundred different tracking SDK’s we use, we can add that in just the coordinator and every other view remains unaware of where it sits within that flow.</li>
<li>It also means that a coordinator can be <strong>reused</strong> within different contexts, helping to reduce code duplication.</li>
<li>And finally this separation of concerns means that each individual element of our flow can be more <strong>easily tested</strong>, giving us a higher confidence that we’re doing the right thing.</li>
</ul>
<hr>
<h2 id="implementation">Implementation.<a hidden class="anchor" aria-hidden="true" href="#implementation">#</a></h2>
<p>The implementation of the coordinator pattern is well documented. It hinges on a protocol with one function declaration — start.</p>
<p>This is the jumping off point for everything that the user flow has to do. The calling class just says “Hey, customer feedback coordinator! Start!”</p>
<p>And off it goes, happily presenting user input forms, confirmation windows or modal dialogues letting the user know that sorry, mismatched plates or a lack of three-ply loo roll aren’t a valid reason to demand a refund on your rented holiday home.</p>
<h2 id="so-whats-the-problem">So what’s the problem?<a hidden class="anchor" aria-hidden="true" href="#so-whats-the-problem">#</a></h2>
<p>Everything looks great!</p>
<p>Well….maybe… well, not quite.</p>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/04-coordinator-communication.jpeg#center" alt="Highlights the dependencies in communicating between objects">
    <div class="caption">[Emphasis mine]</div>
  </figure>
</p>
<p>In a lot of implementations of this pattern, the coordinator retains a collection of child coordinators. Unfortunately, this can lead to a situation where the view is deallocated when dismissed, but there is no mechanism to deallocate the coordinator.
And there is one very important question with this….</p>
<h2 id="how-do-we-deallocate-a-coordinator">How do we deallocate a coordinator?<a hidden class="anchor" aria-hidden="true" href="#how-do-we-deallocate-a-coordinator">#</a></h2>
<p>And the very important answer to this question is…</p>
<p><strong>You don’t.</strong></p>
<h2 id="and-the-reason-you-dont">And the reason you don’t?<a hidden class="anchor" aria-hidden="true" href="#and-the-reason-you-dont">#</a></h2>
<p><strong>You can’t.</strong></p>
<p>Thank you and good night.
….
..
Ok, well actually that’s not quite true.
There are many things you can do.</p>
<hr>
<h3 id="soroush-khanlou">Soroush Khanlou.<a hidden class="anchor" aria-hidden="true" href="#soroush-khanlou">#</a></h3>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/05-saroush_khanlou.jpeg#center" alt="Code: Snippet of Soroush Khanlou&amp;rsquo;s implemention of the coordinator pattern">
    <div class="caption">When I presented this slide to people I was being very dynamic, so imagine me swaying across the floor gesticulating wildly. There is also a typo on this slide which I’m mortified about.</div>
  </figure>
</p>
<p>One example is taken from Soroush Khanlou’s article on Advanced Coordinators.</p>
<p>It works, however in my view, it starts to steer away from the simple purpose of the coordinator.</p>
<p>It becomes the delegation for a navigation controller which means that it would override any previous implementation and cause that to stop working. It also begins to include logic that isn’t immediately apparent what the purpose is. This one method is called on both presentation and dismissal, it checks whether a specific view is contained within a retained collection of child coordinators, if so, it manually removes it from the store….all things that are ripe to cause the same memory issues that led us to this point.</p>
<p>Above all else, by making the coordinator the navigationControllerDelegate, you lose the interactive pop gesture….which is <strong>unacceptable</strong>.</p>
<p>Overall, it just didn’t sit right with me and I quickly began looking for alternative solutions.</p>
<h2 id="bryan-irace">Bryan Irace.<a hidden class="anchor" aria-hidden="true" href="#bryan-irace">#</a></h2>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/06-bryan_irace.gif#center" alt="Code: Snippet of Soroush Khanlou&amp;rsquo;s implemention of the coordinator pattern">
    <div class="caption">In the real presentation, I’d have paced the words to closely fit the graphic. It took a lot of practise to get right, so I&#39;m a bit disappointed I can&#39;t get the same effect in text.</div>
  </figure>
</p>
<p>Here’s another approach by Bryan Irace.
In this, he’s taking the route of making a new controller object called a “NavigationController” (not confusing to me at all), which encapsulates both a coordinator and view controller.</p>
<p>It shares some DNA with Soroush Khanlou’s earlier method by having NavigationController be a UINavigationController delegate as well as the same method to specify which view or coordinator to deallocate. I’d say it’s much more complex than the previous approach, but does encapsulate away some behaviour.</p>
<p>Needless to say, I wasn’t keen to implement this version of the coordinator either.</p>
<h2 id="tutorials-101">Tutorials #101.<a hidden class="anchor" aria-hidden="true" href="#tutorials-101">#</a></h2>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/07-tutorials.jpeg#center" alt="A collage of different tutorials covering the Coordinator pattern">
    <div class="caption">I also mentioned that all of these (waves hand vaguely in the region) are all worthwhile and absolutely worth your time reading.</div>
  </figure>
</p>
<p>There are tons of different articles and GitHub repo’s that cover this topic but none of them seemed to handle things in the way that I wanted — a light object and no requirement to manually deallocate <em>anything</em>.</p>
<p>One important thing to add here, and it is something to emphasis, is that none of the different approaches are <strong>wrong</strong>. They just didn’t seem to fit the way that I wanted it to work. I liked the concept, but couldn’t find an implementation that satisfied my….maybe I can call it “code lust”…no, actually that sounds sketchy. Let’s just say it didn’t satisfy my specific criteria.</p>
<p>So what did I do?</p>
<h2 id="i-gave-up">I Gave Up.<a hidden class="anchor" aria-hidden="true" href="#i-gave-up">#</a></h2>
<p>I’d stare listlessly out of the window looking for inspiration…</p>
<p>I took long walks trying to figure out:</p>
<blockquote>
<p>“How can I cleanly remove a coordinator from memory?”.</p>
</blockquote>
<p>I’m not the most interesting of people, it must be said.</p>
<p>But then, I realised that we already had something in the structure of the application that managed both navigational flow <strong>and</strong> had the ability to let us know when objects were removed from memory.</p>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/08-lightbulb.jpeg#center" alt="A lightbulb">
    <div class="caption">Ting!</div>
  </figure>
</p>
<h2 id="uikit-is-cool">UIKit is cool.<a hidden class="anchor" aria-hidden="true" href="#uikit-is-cool">#</a></h2>
<p>We have UIKit! It’s there, managing view hierarchies, throwing around objects, managing object retention and memory deallocation already. So let’s not fight against it.</p>
<p>Rather than coordinators retaining child coordinators, we make the initial view controller for a particular flow the “root view”, and that becomes the delegate of the coordinator.</p>
<p>The coordinator itself doesn’t have to change and we only need one root view for each coordinator flow.</p>
<p>What does this look like in practise?</p>
<p>In our use case, the coordinator will create the view controllers, but not retain them.</p>
<p>The new root view will hold a reference back to the coordinator and as long as that root view lives (as part of the UIKit view hierarchy), then so will the coordinator.</p>
<p>Other view controllers in the flow do not need to be coordinated. The coordinator is accessible via the root view controller for as long as it stays in memory. Of course, if there is an explicit need to reference a later view, you just need to have a weak reference to that specific controller.</p>
<h2 id="protocols">Protocols.<a hidden class="anchor" aria-hidden="true" href="#protocols">#</a></h2>
<p>Let’s keep the original protocol, I like that bit, and add a little spice to it.</p>
<p>There’s a new protocol called CoordinatedViewController, which specifies just two properties.</p>
<p>The calling coordinator, the one that just created this view controller.</p>
<p>And a closure to be called when the view is deallocated.</p>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/09-my_coordinator.jpeg#center" alt="Code: Shows my ViewController protocol with just two variables - the owning coordinator and a denit closure ">
    <div class="caption">The theme I use in Xcode is a slightly modified Solarize Dark, if you were wondering.</div>
  </figure>
</p>
<p>For the situation where we have child coordinator flows, I’ve added a property to the Coordinator protocol called coordinatorFlowComplete, which is called to tell it’s parent that this particular flow is finished. The parent then can do any other logic/navigation/cleanup that it needs to do with that information.</p>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/10-my_coordinator_start.jpeg#center" alt="Code: My Coordinator protocol, with just a start function and completion variable">
    <div class="caption">I could probably put it on GitHub or something.</div>
  </figure>
</p>
<h2 id="flow-my-views-the-developer-said">Flow my views, the developer said.<a hidden class="anchor" aria-hidden="true" href="#flow-my-views-the-developer-said">#</a></h2>
<p>And this is how it looks in operation — simple!</p>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/11-coordinator_deallocation.gif#center" alt="A gif showing how the objects are removed from memory when dismissing views in the flow">
    <div class="caption">Mr Lattner, I don’t feel so good.</div>
  </figure>
</p>
<p>Going from left to right, we see that a coordinator creates a view controller. The controller is retained by the view hierarchy, in this instance a UINavigationController, and the view retains the coordinator — our “Root View Controller”. As long as this root lives, so does the coordinator.</p>
<p>If the parent coordinator creates a child coordinator, the subsequent root retains that flow and so on…</p>
<p>We can walk this way across the whole user journey and once we’re complete, walk back off the stack deallocating views and coordinators as we go. Once a root view controller deallocates, so does all of the coordinator resources along with him, all the way back to the parent.</p>
<p>So using this approach, there are a few things to note.</p>
<ul>
<li>The memory lifecycle is consistent with how we expect our UIKit apps to work. We don’t have to be manually removing objects from retained objects, instead we just leverage our existing functions and observers.</li>
<li>I’ve opted for protocol conformance rather than subclassing as that allows us to have a clearly defined “contract” with the specific view controller we want to become coordinated. As I mentioned earlier, not all views in a flow need to be coordinated and in this instance they don’t need to implement this protocol.</li>
<li>Minimal code changes to existing coordinator implementations. Since all we have really done is flip the reference chain upside down, you can try this alongside your current approach and see how you fare. It also doesn’t require many changes to how view controllers are constructed.</li>
<li>Most importantly of all, it doesn’t require the UINavigationControllerDelegate. Meaning I can still use the default interactive pop gesture. This is acceptable.</li>
</ul>
<hr>
<h2 id="whats-the-point">What’s the point?<a hidden class="anchor" aria-hidden="true" href="#whats-the-point">#</a></h2>
<p>
  <figure>
    <img src="/images/coordinator-brain-soup/12-xkcd_standards.png#center" alt="A gif showing how the objects are removed from memory when dismissing views in the flow">
    <div class="caption">https://xkcd.com/927</div>
  </figure>
</p>
<p>At the end of the day, all I’ve basically ended up with is yet another implementation on top of a giant pile of existing implementations. Why bother?</p>
<p>Sure, it shares some properties of a few different design patterns, but with one slight twist.</p>
<p>This one <em>made sense to me</em>.</p>
<p>And that’s the real purpose of this article (talk), the code itself and the final pattern are mostly irrelevant.</p>
<p>This is really about the bit in the middle — how did I get this this point of being able to reach down, grab my variation on a theme and add it to the rest of the other ways of doing things?</p>
<p>And there are really two key take aways I’d like to share on that point.</p>
<h3 id="1-there-is-always-another-way">1. There is always another way.<a hidden class="anchor" aria-hidden="true" href="#1-there-is-always-another-way">#</a></h3>
<p>Articles, blog posts, tweets or StackOverflow are incredible resources to have to help you find an approach to take. But they aren’t irrefutable.</p>
<p>We can read these other resources to give us an understanding of the problem we are trying to solve. And by understanding that problem, we’re able to come to our own conclusions and find a solution that works for the unique circumstances and requirements our project has.</p>
<p>It took me a long time to come to that solution, but having a grounding on how other people had attacked their problem enabled me to find something that fit our purpose.</p>
<p>This also means that the approach above may not work for you or your projects, but there may be some small element within there that nudges you one step further along your own journey to discovering your specific answer.</p>
<h3 id="2-know-what-you-want-not-how-to-do-it">2. Know what you want, not how to do it.<a hidden class="anchor" aria-hidden="true" href="#2-know-what-you-want-not-how-to-do-it">#</a></h3>
<p>Early on in this voyage of self-loathing, I knew that I wasn’t keen on many other implementations of this pattern. Even though I didn’t know <strong>how</strong> to do what I wanted, I had a clear idea of <strong>what</strong> I did want to happen, and what I <strong>didn’t</strong> want to happen.</p>
<p>I wanted to have navigation taken out of the view controller.</p>
<p>I didn’t want to have to manually deallocate objects.</p>
<p>I wanted to do as little work as possible.</p>
<p>And even though I struggled to achieve these goals, it helped me to throw away code when it didn’t satisfy my objective.</p>
<p>Written a class that doesn’t get deallocated? Throw the code away, try something else.</p>
<p>Coordinator becoming bloated? Throw the code away, try something else.</p>
<p>Protocol having too many properties? Throw the code away.</p>
<p>Because I knew how I wanted this thing to work, I was able to check off each of these requirements and if any part didn’t match up — I’d bin it and walk away. But on the flip side, when I was able to get an implementation that ticked all of those boxes, I <em>knew</em> that it worked.</p>
<p>In any software development process, the implementation is there to action the behaviour that you want to occur and I had to keep that in mind every time I tried to let existing code influence or determine how I attained that behaviour, even if it meant putting everything in the bin.</p>
<h2 id="final-words">Final words.<a hidden class="anchor" aria-hidden="true" href="#final-words">#</a></h2>
<p>There you have it, this is what I presented once and may present again.</p>
<p>I hope there is something in this that you find useful, even if it’s only in knowing that there is at least one person working in a professional capacity that wasn’t able to grasp the concept of coordinators without losing their mind.</p>
<p>There is a demo of this project available on GitHub, please take a look and see what you think. Maybe it won’t help, maybe it’ll make you laugh or maybe it’ll be a little pointer to helping you to find your own way of doing things.</p>
<p>Demo project available at <a href="https://github.com/michaelsprindzuikate/coordinator_example">https://github.com/michaelsprindzuikate/coordinator_example</a></p>

</div>
  <footer class="post-footer">



<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share How the Coordinator Pattern Broke My Brain on twitter"
        href="https://twitter.com/intent/tweet/?text=How%20the%20Coordinator%20Pattern%20Broke%20My%20Brain&amp;url=%2fposts%2fcoordinators-brain-soup%2f&amp;hashtags=">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How the Coordinator Pattern Broke My Brain on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fposts%2fcoordinators-brain-soup%2f&amp;title=How%20the%20Coordinator%20Pattern%20Broke%20My%20Brain&amp;summary=How%20the%20Coordinator%20Pattern%20Broke%20My%20Brain&amp;source=%2fposts%2fcoordinators-brain-soup%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How the Coordinator Pattern Broke My Brain on reddit"
        href="https://reddit.com/submit?url=%2fposts%2fcoordinators-brain-soup%2f&title=How%20the%20Coordinator%20Pattern%20Broke%20My%20Brain">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How the Coordinator Pattern Broke My Brain on facebook"
        href="https://facebook.com/sharer/sharer.php?u=%2fposts%2fcoordinators-brain-soup%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How the Coordinator Pattern Broke My Brain on whatsapp"
        href="https://api.whatsapp.com/send?text=How%20the%20Coordinator%20Pattern%20Broke%20My%20Brain%20-%20%2fposts%2fcoordinators-brain-soup%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share How the Coordinator Pattern Broke My Brain on telegram"
        href="https://telegram.me/share/url?text=How%20the%20Coordinator%20Pattern%20Broke%20My%20Brain&amp;url=%2fposts%2fcoordinators-brain-soup%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="/">michael s.</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>



<script defer src="/assets/js/highlight.min.bbd85caebf800eb92fff4930cb2d4172.js" integrity="md5-u9hcrr&#43;ADrkv/0kwyy1Bcg=="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
